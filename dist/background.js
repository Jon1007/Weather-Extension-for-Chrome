(()=>{"use strict";function e(e){const t={cities:e};return new Promise((e=>{chrome.storage.local.set(t,(()=>e()))}))}chrome.runtime.onInstalled.addListener((()=>{e([]),function(e){const t={options:{hasAutoOverlay:!1,homeCity:"",tempScale:"metric"}};new Promise((e=>{chrome.storage.local.set(t,(()=>{e()}))}))}(),chrome.contextMenus.create({contexts:["selection"],title:"Add city to weather extension",id:"weatherExtension"}),chrome.alarms.create({periodInMinutes:1/6})})),chrome.contextMenus.onClicked.addListener((t=>{(function(){const e=["cities"];return new Promise((t=>{chrome.storage.local.get(e,(e=>{var n;t(null!==(n=e.cities)&&void 0!==n?n:[])}))}))})().then((n=>{e([...n,t.selectionText])}))})),chrome.alarms.onAlarm.addListener((()=>{(function(){const e=["options"];return new Promise((t=>{chrome.storage.local.get(e,(e=>{t(e.options)}))}))})().then((e=>{""!==e.homeCity&&function(e,t){return n=this,o=void 0,r=function*(){const n=yield fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&units=${t}&appid=9ad3f6dd76fe06e2192086d9b7a45b1b`);if(!n.ok)throw new Error("City not found");return yield n.json()},new((i=void 0)||(i=Promise))((function(e,t){function c(e){try{s(r.next(e))}catch(e){t(e)}}function a(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(c,a)}s((r=r.apply(n,o||[])).next())}));var n,o,i,r}(e.homeCity,e.tempScale).then((t=>{const n=Math.round(t.main.temp),o="metric"===e.tempScale?"℃":"℉";chrome.action.setBadgeText({text:`${n}${o}`})}))}))}))})();